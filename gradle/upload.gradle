
apply plugin: 'maven-publish'

publishing {
    publications {
        library(MavenPublication) {
            from components.java
        }
    }
    repositories {

            def urlPrefix = "https://gitlab.botaoyx.com/api/v4"
            def tokenName = "Private-Token"
            def tokenValue = System.getProperty(tokenName)
            if(System.getenv("CI_JOB_TOKEN")!=null){
                urlPrefix = "${CI_API_V4_URL}"
                tokenName =  'Job-Token'
                tokenValue = System.getenv("CI_JOB_TOKEN")
            }

            maven {
                url "$urlPrefix/projects/4/packages/maven"
                credentials(HttpHeaderCredentials) {
                    name = tokenName
                    value = tokenValue
                }
                authentication {
                    header(HttpHeaderAuthentication)
                }
            }
    }
}


//apply plugin: 'com.jfrog.artifactory'
//
//artifactory {
//    contextUrl = "https://jfrog.io/bt"
//    publish {
//        repository {
//            repoKey = 'gradle-local-dev'
////            username = "${artifactory_user}"
////            password = "${artifactory_password}"
//            maven = true
//        }
//
//        defaults {
//            publishConfigs('archives', 'published')
//            publishIvy = false
//        }
//    }
//}

//configurations {
//    published
//}

task sourceJar(type: Jar) {
    from sourceSets.main.allSource
    classifier = 'sources'
}

task javadocJar(type: Jar, dependsOn: javadoc) {
    classifier = 'javadoc'
    from javadoc.destinationDir
}


artifacts {
    archives sourceJar
    archives javadocJar
}
